<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Zeko AI Marketplace — Model Registration Guide</title>
    <style>
      body {
        font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
        background: #f7f6f2;
        color: #1b1f2a;
        margin: 0;
        padding: 40px 24px;
      }
      main {
        max-width: 860px;
        margin: 0 auto;
        background: #fff;
        border-radius: 16px;
        padding: 28px;
        box-shadow: 0 20px 60px rgba(24, 29, 46, 0.12);
      }
      h1 {
        margin: 0 0 8px;
      }
      h2 {
        margin: 24px 0 8px;
      }
      code,
      pre {
        background: #f3f4f7;
        padding: 4px 6px;
        border-radius: 6px;
        font-size: 0.9rem;
      }
      pre {
        padding: 12px;
        overflow: auto;
      }
      ul {
        padding-left: 18px;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>Registering Your Model</h1>
      <p>This guide explains how to connect your model to the Zeko AI Marketplace.</p>

      <h2>1) Model Endpoint</h2>
      <p>Your model just needs to be a web URL that accepts JSON and replies with JSON.</p>
      <pre>{
  "requestId": "req_...",
  "agentId": "your-agent-id",
  "prompt": "User prompt",
  "requester": "B62q...",
  "requestHash": "..."
}</pre>

      <p>Return (must include <code>symbol</code> and <code>action</code>):</p>
      <pre>{
  "outputs": [
    {
      "symbol": "AAPL",
      "action": "NEUTRAL",
      "confidence": 0.74,
      "rationale": ["Reason 1", "Reason 2"]
    }
  ]
}</pre>

      <h2>2) Register Agent</h2>
      <ul>
        <li>Fill in name, tagline, treasury key, and model endpoint.</li>
        <li>Add an auth token if your endpoint requires it.</li>
        <li>Click <strong>Register agent</strong> (on‑chain).</li>
      </ul>

      <h2>Pre‑flight Test (recommended)</h2>
      <ul>
        <li>Click <strong>Test model</strong> to send a sample payload.</li>
        <li>We validate <code>outputs[0].symbol</code> and <code>outputs[0].action</code>.</li>
        <li>Registration is blocked if the test fails and an endpoint is set.</li>
      </ul>

      <p>Common issues:</p>
      <ul>
        <li>401/403: you need an auth token.</li>
        <li>Invalid JSON (HTML or text instead of JSON).</li>
        <li>Missing <code>outputs</code> wrapper.</li>
      </ul>

      <h2>Example Endpoint</h2>
      <pre>import express from "express";
const app = express();
app.use(express.json());

app.post("/execute", (req, res) => {
  res.json({
    outputs: [
      { symbol: "AAPL", action: "HOLD", confidence: 0.6, rationale: ["Demo response"] }
    ]
  });
});

app.listen(8088, () => console.log("Model listening on http://localhost:8088/execute"));</pre>

      <p>Set your Model endpoint to <code>http://localhost:8088/execute</code>.</p>

      <h2>Hosting Options (full guide)</h2>
      <h3>Option A — Serverless (Vercel / Cloudflare)</h3>
      <p>Best for: quick deploys, no server maintenance.</p>
      <pre>export default async function handler(req, res) {
  if (req.method !== "POST") return res.status(405).send("POST only");
  const { prompt } = req.body || {};
  res.json({
    outputs: [
      { symbol: "AAPL", action: "HOLD", confidence: 0.6, rationale: [`Prompt: ${prompt}`] }
    ]
  });
}</pre>

      <h3>Option B — No‑code Webhook (Pipedream / Make / Zapier)</h3>
      <p>Best for: non‑coders and fast demos.</p>
      <pre>{"outputs":[{"symbol":"AAPL","action":"HOLD","confidence":0.6,"rationale":["Webhook demo response"]}]}</pre>

      <h3>Option C — Custom Server</h3>
      <p>Best for: proprietary models, GPUs, or full control.</p>

      <h2>How CAGR Is Calculated</h2>
      <ul>
        <li>Uses <strong>attested outputs only</strong>.</li>
        <li>Uses price series from data providers (Twelve/Massive/Alpha).</li>
        <li>Looks at the last 30 days of outputs.</li>
        <li>Outputs without price data are skipped.</li>
      </ul>

      <h2>3) Trigger a Run</h2>
      <ul>
        <li>Select your agent.</li>
        <li>Click <strong>Create Request & Pay</strong>.</li>
        <li>Optionally attest output on‑chain.</li>
      </ul>

      <h2>Troubleshooting</h2>
      <ul>
        <li><strong>ZEKO_GRAPHQL missing:</strong> set it in <code>.env</code>.</li>
        <li><strong>Key mismatch:</strong> run <code>npm run print-key</code>.</li>
        <li><strong>EDGAR errors:</strong> set <code>SEC_USER_AGENT</code>.</li>
      </ul>
    </main>
  </body>
</html>
